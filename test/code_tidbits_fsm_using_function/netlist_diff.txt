--- verilog_synth
+++ uhdm_synth
@@ -1,24 +1,24 @@
 /* Generated by Yosys 0.62+39 (git sha1 131911291-dirty, g++ 11.4.0-1ubuntu1~22.04.2 -Og -fPIC) */
 (* dynports =  1  *)
-(* top =  1  *)
 (* src = "dut.sv:6.1-94.10" *)
+(* top =  1  *)
 module fsm_using_function(clock, reset, req_0, req_1, gnt_0, gnt_1);
-(* src = "dut.sv:15.9-15.14" *)
+(* src = "dut.sv:7.1-7.6" *)
 input clock;
 wire clock;
-(* src = "dut.sv:15.15-15.20" *)
+(* src = "dut.sv:8.1-8.6" *)
 input reset;
 wire reset;
-(* src = "dut.sv:15.21-15.26" *)
+(* src = "dut.sv:9.1-9.6" *)
 input req_0;
 wire req_0;
-(* src = "dut.sv:15.27-15.32" *)
+(* src = "dut.sv:10.1-10.6" *)
 input req_1;
 wire req_1;
-(* src = "dut.sv:17.9-17.14" *)
+(* src = "dut.sv:11.1-11.6" *)
 output gnt_0;
 wire gnt_0;
-(* src = "dut.sv:17.15-17.20" *)
+(* src = "dut.sv:12.1-12.6" *)
 output gnt_1;
 wire gnt_1;
 wire _00_;
@@ -46,22 +46,13 @@
 wire _22_;
 wire _23_;
 (* force_downto = 32'd1 *)
-(* src = "dut.sv:47.18-47.18|dut.sv:35.3-54.10|/home/alain/uhdm2rtlil/out/current/bin/../share/yosys/techmap.v:581.22-581.23" *)
+(* src = "dut.sv:48.4-52.18|dut.sv:35.3-54.10|/home/alain/uhdm2rtlil/out/current/bin/../share/yosys/techmap.v:581.22-581.23" *)
 (* unused_bits = "2" *)
 wire [2:0] _24_;
-(* src = "dut.sv:31.33-31.33" *)
 wire [2:0] \fsm_function$func$dut.sv:29$1.$result ;
-(* nosync = 32'd1 *)
-(* src = "dut.sv:33.12-33.17" *)
-wire \fsm_function$func$dut.sv:29$2.req_0 ;
-(* nosync = 32'd1 *)
-(* src = "dut.sv:34.12-34.17" *)
-wire \fsm_function$func$dut.sv:29$2.req_1 ;
-(* nosync = 32'd1 *)
-(* src = "dut.sv:32.22-32.27" *)
-wire [2:0] \fsm_function$func$dut.sv:29$2.state ;
 (* src = "dut.sv:27.27-27.37" *)
 wire [2:0] next_state;
+(* \reg  = 32'd1 *)
 (* src = "dut.sv:26.27-26.32" *)
 wire [2:0] state;
 \$_NOT_  _25_ (
@@ -69,8 +60,8 @@
 .Y(_00_)
 );
 \$_OR_  _26_ (
-.A(state[0]),
-.B(state[1]),
+.A(state[1]),
+.B(state[0]),
 .Y(_01_)
 );
 \$_OR_  _27_ (
@@ -145,49 +136,49 @@
 .A(req_1),
 .Y(_13_)
 );
-\$_ANDNOT_  _42_ (
-.A(_13_),
-.B(_02_),
+\$_OR_  _42_ (
+.A(_02_),
+.B(_13_),
 .Y(_14_)
 );
-\$_ANDNOT_  _43_ (
-.A(_06_),
-.B(_04_),
+\$_ORNOT_  _43_ (
+.A(req_0),
+.B(req_1),
 .Y(_15_)
 );
-\$_OR_  _44_ (
-.A(_15_),
-.B(_14_),
+\$_ANDNOT_  _44_ (
+.A(_08_),
+.B(_15_),
 .Y(_16_)
 );
-\$_OR_  _45_ (
-.A(req_1),
-.B(req_0),
+\$_ANDNOT_  _45_ (
+.A(_14_),
+.B(_16_),
 .Y(_17_)
 );
-\$_ANDNOT_  _46_ (
-.A(_08_),
-.B(_17_),
+\$_NOR_  _46_ (
+.A(_17_),
+.B(_12_),
+.Y(\fsm_function$func$dut.sv:29$1.$result [2])
+);
+\$_ANDNOT_  _47_ (
+.A(_13_),
+.B(_02_),
 .Y(_18_)
 );
-\$_OR_  _47_ (
-.A(_18_),
-.B(_16_),
+\$_ANDNOT_  _48_ (
+.A(_06_),
+.B(_04_),
 .Y(_19_)
 );
-\$_OR_  _48_ (
-.A(_19_),
-.B(_12_),
-.Y(\fsm_function$func$dut.sv:29$1.$result [0])
-);
 \$_OR_  _49_ (
-.A(_02_),
-.B(_13_),
+.A(_19_),
+.B(_18_),
 .Y(_20_)
 );
-\$_ORNOT_  _50_ (
-.A(req_0),
-.B(req_1),
+\$_OR_  _50_ (
+.A(req_1),
+.B(req_0),
 .Y(_21_)
 );
 \$_ANDNOT_  _51_ (
@@ -195,16 +186,17 @@
 .B(_21_),
 .Y(_22_)
 );
-\$_ANDNOT_  _52_ (
-.A(_20_),
-.B(_22_),
+\$_OR_  _52_ (
+.A(_22_),
+.B(_20_),
 .Y(_23_)
 );
-\$_NOR_  _53_ (
+\$_OR_  _53_ (
 .A(_23_),
 .B(_12_),
-.Y(\fsm_function$func$dut.sv:29$1.$result [2])
+.Y(\fsm_function$func$dut.sv:29$1.$result [0])
 );
+(* \always_ff  = 32'd1 *)
 (* src = "dut.sv:66.1-92.4" *)
 \$_SDFF_PP0_  gnt_0_reg /* _54_ */ (
 .C(clock),
@@ -212,6 +204,7 @@
 .Q(gnt_0),
 .R(reset)
 );
+(* \always_ff  = 32'd1 *)
 (* src = "dut.sv:66.1-92.4" *)
 \$_SDFF_PP0_  gnt_1_reg /* _55_ */ (
 .C(clock),
@@ -219,6 +212,7 @@
 .Q(gnt_1),
 .R(reset)
 );
+(* \always_ff  = 32'd1 *)
 (* src = "dut.sv:57.1-64.4" *)
 \$_SDFF_PP1_  \state_reg[0]  /* _56_ */ (
 .C(clock),
@@ -226,6 +220,7 @@
 .Q(state[0]),
 .R(reset)
 );
+(* \always_ff  = 32'd1 *)
 (* src = "dut.sv:57.1-64.4" *)
 \$_SDFF_PP0_  \state_reg[1]  /* _57_ */ (
 .C(clock),
@@ -233,6 +228,7 @@
 .Q(state[1]),
 .R(reset)
 );
+(* \always_ff  = 32'd1 *)
 (* src = "dut.sv:57.1-64.4" *)
 \$_SDFF_PP0_  \state_reg[2]  /* _58_ */ (
 .C(clock),
@@ -240,8 +236,5 @@
 .Q(state[2]),
 .R(reset)
 );
-assign \fsm_function$func$dut.sv:29$2.req_1  = 1'hx;
-assign \fsm_function$func$dut.sv:29$2.req_0  = 1'hx;
-assign \fsm_function$func$dut.sv:29$2.state  = 3'hx;
 assign next_state = \fsm_function$func$dut.sv:29$1.$result ;
 endmodule
