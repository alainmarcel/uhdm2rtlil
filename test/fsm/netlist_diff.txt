--- verilog_synth
+++ uhdm_synth
@@ -1,24 +1,24 @@
 /* Generated by Yosys 0.56+171 (git sha1 6fdcdd41d, g++ 11.4.0-1ubuntu1~22.04.2 -Og -fPIC) */
-(* dynports =  1  *)
 (* top =  1  *)
+(* dynports =  1  *)
 (* src = "dut.sv:1.2-51.10" *)
 module fsm(clock, reset, req_0, req_1, gnt_0, gnt_1);
-(* src = "dut.sv:2.13-2.18" *)
+(* src = "dut.sv:1.15-1.20" *)
 input clock;
 wire clock;
-(* src = "dut.sv:2.19-2.24" *)
+(* src = "dut.sv:1.22-1.27" *)
 input reset;
 wire reset;
-(* src = "dut.sv:2.25-2.30" *)
+(* src = "dut.sv:1.29-1.34" *)
 input req_0;
 wire req_0;
-(* src = "dut.sv:2.31-2.36" *)
+(* src = "dut.sv:1.36-1.41" *)
 input req_1;
 wire req_1;
-(* src = "dut.sv:3.13-3.18" *)
+(* src = "dut.sv:1.43-1.48" *)
 output gnt_0;
 wire gnt_0;
-(* src = "dut.sv:3.19-3.24" *)
+(* src = "dut.sv:1.50-1.55" *)
 output gnt_1;
 wire gnt_1;
 wire _00_;
@@ -54,259 +54,214 @@
 wire _30_;
 wire _31_;
 wire _32_;
-wire _33_;
-wire _34_;
-wire _35_;
-wire _36_;
-(* force_downto = 32'd1 *)
-(* src = "dut.sv:43.26-43.26|dut.sv:24.13-49.20|/home/alain/uhdm2rtlil/out/current/bin/../share/yosys/techmap.v:576.21-576.22" *)
-wire [2:0] _37_;
-(* force_downto = 32'd1 *)
-(* src = "dut.sv:43.26-43.26|dut.sv:24.13-49.20|/home/alain/uhdm2rtlil/out/current/bin/../share/yosys/techmap.v:576.21-576.22" *)
-wire [0:0] _38_;
+(* \reg  = 32'd1 *)
 (* src = "dut.sv:13.20-13.25" *)
 wire [2:0] state;
-\$_NOT_  _39_ (
+\$_NOT_  _33_ (
 .A(req_0),
-.Y(_04_)
+.Y(_09_)
 );
-\$_ORNOT_  _40_ (
+\$_ORNOT_  _34_ (
 .A(state[0]),
 .B(state[1]),
-.Y(_05_)
-);
-\$_OR_  _41_ (
-.A(_05_),
-.B(state[2]),
-.Y(_03_)
-);
-\$_NOT_  _42_ (
-.A(state[2]),
-.Y(_06_)
-);
-\$_ORNOT_  _43_ (
-.A(state[1]),
-.B(state[0]),
-.Y(_07_)
-);
-\$_ANDNOT_  _44_ (
-.A(_06_),
-.B(_07_),
-.Y(_08_)
-);
-\$_MUX_  _45_ (
-.A(_03_),
-.B(_04_),
-.S(_08_),
-.Y(_09_)
-);
-\$_OR_  _46_ (
-.A(_03_),
-.B(_04_),
 .Y(_10_)
 );
-\$_ANDNOT_  _47_ (
+\$_OR_  _35_ (
 .A(_10_),
-.B(_09_),
-.Y(_00_)
-);
-\$_OR_  _48_ (
-.A(_07_),
 .B(state[2]),
 .Y(_11_)
 );
-\$_OR_  _49_ (
-.A(_07_),
-.B(_06_),
+\$_OR_  _36_ (
+.A(_11_),
+.B(reset),
 .Y(_12_)
 );
-\$_MUX_  _50_ (
-.A(_12_),
-.B(_11_),
-.S(req_0),
+\$_ANDNOT_  _37_ (
+.A(_09_),
+.B(_12_),
+.Y(_04_)
+);
+\$_ORNOT_  _38_ (
+.A(_04_),
+.B(reset),
 .Y(_13_)
 );
-\$_NOT_  _51_ (
-.A(req_1),
+\$_NOT_  _39_ (
+.A(state[2]),
 .Y(_14_)
 );
-\$_OR_  _52_ (
-.A(state[0]),
-.B(state[1]),
+\$_OR_  _40_ (
+.A(state[1]),
+.B(state[0]),
 .Y(_15_)
 );
-\$_OR_  _53_ (
+\$_OR_  _41_ (
 .A(_15_),
-.B(_06_),
+.B(_14_),
 .Y(_16_)
 );
-\$_ANDNOT_  _54_ (
-.A(_14_),
-.B(_16_),
+\$_OR_  _42_ (
+.A(_16_),
+.B(reset),
 .Y(_17_)
 );
-\$_ANDNOT_  _55_ (
-.A(_14_),
-.B(_11_),
+\$_ANDNOT_  _43_ (
+.A(req_1),
+.B(_17_),
 .Y(_18_)
 );
-\$_OR_  _56_ (
-.A(_18_),
-.B(_17_),
+\$_ORNOT_  _44_ (
+.A(state[1]),
+.B(state[0]),
 .Y(_19_)
 );
-\$_ANDNOT_  _57_ (
-.A(_13_),
-.B(_19_),
+\$_OR_  _45_ (
+.A(_19_),
+.B(_14_),
 .Y(_20_)
 );
-\$_ORNOT_  _58_ (
-.A(state[1]),
-.B(state[2]),
+\$_OR_  _46_ (
+.A(_20_),
+.B(reset),
 .Y(_21_)
 );
-\$_ANDNOT_  _59_ (
-.A(_21_),
-.B(_08_),
+\$_ANDNOT_  _47_ (
+.A(req_0),
+.B(_21_),
 .Y(_22_)
 );
-\$_ANDNOT_  _60_ (
-.A(_20_),
-.B(_22_),
-.Y(_01_)
+\$_OR_  _48_ (
+.A(_22_),
+.B(_18_),
+.Y(_07_)
 );
-\$_OR_  _61_ (
-.A(_12_),
-.B(req_0),
+\$_OR_  _49_ (
+.A(_07_),
+.B(_13_),
+.Y(_02_)
+);
+\$_OR_  _50_ (
+.A(_19_),
+.B(state[2]),
 .Y(_23_)
 );
-\$_ANDNOT_  _62_ (
+\$_OR_  _51_ (
 .A(_23_),
-.B(_17_),
-.Y(_02_)
-);
-\$_ANDNOT_  _63_ (
-.A(_03_),
-.B(_08_),
+.B(reset),
 .Y(_24_)
 );
-\$_NAND_  _64_ (
-.A(_21_),
+\$_ANDNOT_  _52_ (
+.A(_09_),
 .B(_24_),
 .Y(_25_)
 );
-\$_ANDNOT_  _65_ (
-.A(_04_),
-.B(_03_),
+\$_AND_  _53_ (
+.A(_25_),
+.B(req_1),
 .Y(_26_)
 );
-\$_OR_  _66_ (
-.A(req_1),
-.B(req_0),
+\$_OR_  _54_ (
+.A(_26_),
+.B(reset),
 .Y(_27_)
 );
-\$_ANDNOT_  _67_ (
-.A(_08_),
-.B(_27_),
+\$_OR_  _55_ (
+.A(_27_),
+.B(_07_),
+.Y(_00_)
+);
+\$_ANDNOT_  _56_ (
+.A(req_0),
+.B(_24_),
+.Y(_03_)
+);
+\$_OR_  _57_ (
+.A(_03_),
+.B(reset),
+.Y(_01_)
+);
+\$_ANDNOT_  _58_ (
+.A(req_0),
+.B(_12_),
 .Y(_28_)
 );
-\$_OR_  _68_ (
-.A(_28_),
-.B(_26_),
+\$_MUX_  _59_ (
+.A(_03_),
+.B(req_1),
+.S(_25_),
 .Y(_29_)
 );
-\$_ANDNOT_  _69_ (
-.A(_16_),
+\$_OR_  _60_ (
+.A(_29_),
+.B(_28_),
+.Y(_05_)
+);
+\$_MUX_  _61_ (
+.A(req_0),
 .B(_29_),
+.S(_12_),
 .Y(_30_)
 );
-\$_NAND_  _70_ (
+\$_ANDNOT_  _62_ (
 .A(_30_),
-.B(_25_),
-.Y(_37_[0])
-);
-\$_NOR_  _71_ (
-.A(req_1),
-.B(req_0),
+.B(_18_),
 .Y(_31_)
 );
-\$_ANDNOT_  _72_ (
-.A(_08_),
-.B(_31_),
-.Y(_32_)
-);
-\$_ANDNOT_  _73_ (
-.A(_10_),
-.B(_32_),
-.Y(_33_)
-);
-\$_ANDNOT_  _74_ (
-.A(_25_),
-.B(_33_),
-.Y(_37_[1])
-);
-\$_ANDNOT_  _75_ (
-.A(state[2]),
-.B(state[1]),
-.Y(_37_[2])
-);
-\$_ANDNOT_  _76_ (
-.A(req_1),
-.B(_12_),
-.Y(_34_)
-);
-\$_ANDNOT_  _77_ (
-.A(req_0),
-.B(_16_),
-.Y(_35_)
+\$_NOR_  _63_ (
+.A(_31_),
+.B(_22_),
+.Y(_06_)
 );
-\$_OR_  _78_ (
-.A(_35_),
-.B(_34_),
-.Y(_36_)
+\$_MUX_  _64_ (
+.A(_26_),
+.B(req_0),
+.S(_18_),
+.Y(_32_)
 );
-\$_OR_  _79_ (
-.A(_36_),
-.B(_21_),
-.Y(_38_)
+\$_MUX_  _65_ (
+.A(_32_),
+.B(req_1),
+.S(_22_),
+.Y(_08_)
 );
+(* \always_ff  = 32'd1 *)
 (* src = "dut.sv:16.5-50.12" *)
-\$_SDFFE_PP0P_  gnt_0_reg /* _80_ */ (
+\$_DFFE_PP_  gnt_1_reg /* _66_ */ (
 .C(clock),
-.D(_03_),
+.D(_08_),
 .E(_00_),
-.Q(gnt_0),
-.R(reset)
+.Q(gnt_1)
 );
+(* \always_ff  = 32'd1 *)
 (* src = "dut.sv:16.5-50.12" *)
-\$_SDFFE_PP0P_  gnt_1_reg /* _81_ */ (
+\$_SDFF_PP0_  \state_reg[1]  /* _67_ */ (
 .C(clock),
-.D(_38_),
-.E(_01_),
-.Q(gnt_1),
-.R(reset)
+.D(_05_),
+.Q(state[1]),
+.R(_02_)
 );
+(* \always_ff  = 32'd1 *)
 (* src = "dut.sv:16.5-50.12" *)
-\$_SDFFE_PP1P_  \state_reg[0]  /* _82_ */ (
+\$_SDFFE_PP0P_  gnt_0_reg /* _68_ */ (
 .C(clock),
-.D(_37_[0]),
-.E(_02_),
-.Q(state[0]),
-.R(reset)
+.D(_03_),
+.E(_01_),
+.Q(gnt_0),
+.R(_04_)
 );
+(* \always_ff  = 32'd1 *)
 (* src = "dut.sv:16.5-50.12" *)
-\$_SDFFE_PP0P_  \state_reg[1]  /* _83_ */ (
+\$_SDFF_PN1_  \state_reg[0]  /* _69_ */ (
 .C(clock),
-.D(_37_[1]),
-.E(_02_),
-.Q(state[1]),
+.D(_06_),
+.Q(state[0]),
 .R(reset)
 );
+(* \always_ff  = 32'd1 *)
 (* src = "dut.sv:16.5-50.12" *)
-\$_SDFFE_PP0P_  \state_reg[2]  /* _84_ */ (
+\$_SDFF_PN0_  \state_reg[2]  /* _70_ */ (
 .C(clock),
-.D(_37_[2]),
-.E(_02_),
+.D(_07_),
 .Q(state[2]),
 .R(reset)
 );
