--- verilog_synth
+++ uhdm_synth
@@ -1,24 +1,24 @@
 /* Generated by Yosys 0.56+171 (git sha1 6fdcdd41d, g++ 11.4.0-1ubuntu1~22.04.2 -Og -fPIC) */
 (* dynports =  1  *)
-(* top =  1  *)
 (* src = "dut.sv:1.2-51.10" *)
+(* top =  1  *)
 module fsm(clock, reset, req_0, req_1, gnt_0, gnt_1);
-(* src = "dut.sv:2.13-2.18" *)
+(* src = "dut.sv:1.15-1.20" *)
 input clock;
 wire clock;
-(* src = "dut.sv:2.19-2.24" *)
+(* src = "dut.sv:1.22-1.27" *)
 input reset;
 wire reset;
-(* src = "dut.sv:2.25-2.30" *)
+(* src = "dut.sv:1.29-1.34" *)
 input req_0;
 wire req_0;
-(* src = "dut.sv:2.31-2.36" *)
+(* src = "dut.sv:1.36-1.41" *)
 input req_1;
 wire req_1;
-(* src = "dut.sv:3.13-3.18" *)
+(* src = "dut.sv:1.43-1.48" *)
 output gnt_0;
 wire gnt_0;
-(* src = "dut.sv:3.19-3.24" *)
+(* src = "dut.sv:1.50-1.55" *)
 output gnt_1;
 wire gnt_1;
 wire _00_;
@@ -58,256 +58,292 @@
 wire _34_;
 wire _35_;
 wire _36_;
-(* force_downto = 32'd1 *)
-(* src = "dut.sv:43.26-43.26|dut.sv:24.13-49.20|/home/alain/uhdm2rtlil/out/current/bin/../share/yosys/techmap.v:576.21-576.22" *)
-wire [2:0] _37_;
-(* force_downto = 32'd1 *)
-(* src = "dut.sv:43.26-43.26|dut.sv:24.13-49.20|/home/alain/uhdm2rtlil/out/current/bin/../share/yosys/techmap.v:576.21-576.22" *)
-wire [0:0] _38_;
+wire _37_;
+wire _38_;
+wire _39_;
+wire _40_;
+wire _41_;
+wire _42_;
+wire _43_;
+wire _44_;
+wire _45_;
+(* \reg  = 32'd1 *)
 (* src = "dut.sv:13.20-13.25" *)
 wire [2:0] state;
-\$_NOT_  _39_ (
+\$_NOT_  _46_ (
 .A(req_0),
-.Y(_04_)
+.Y(_12_)
 );
-\$_ORNOT_  _40_ (
+\$_ORNOT_  _47_ (
 .A(state[0]),
 .B(state[1]),
-.Y(_05_)
-);
-\$_OR_  _41_ (
-.A(_05_),
-.B(state[2]),
-.Y(_03_)
-);
-\$_NOT_  _42_ (
-.A(state[2]),
-.Y(_06_)
-);
-\$_ORNOT_  _43_ (
-.A(state[1]),
-.B(state[0]),
-.Y(_07_)
-);
-\$_ANDNOT_  _44_ (
-.A(_06_),
-.B(_07_),
-.Y(_08_)
-);
-\$_MUX_  _45_ (
-.A(_03_),
-.B(_04_),
-.S(_08_),
-.Y(_09_)
-);
-\$_OR_  _46_ (
-.A(_03_),
-.B(_04_),
-.Y(_10_)
-);
-\$_ANDNOT_  _47_ (
-.A(_10_),
-.B(_09_),
-.Y(_00_)
+.Y(_13_)
 );
 \$_OR_  _48_ (
-.A(_07_),
+.A(_13_),
 .B(state[2]),
-.Y(_11_)
+.Y(_14_)
 );
 \$_OR_  _49_ (
-.A(_07_),
-.B(_06_),
-.Y(_12_)
+.A(_14_),
+.B(reset),
+.Y(_15_)
 );
-\$_MUX_  _50_ (
+\$_ANDNOT_  _50_ (
 .A(_12_),
-.B(_11_),
-.S(req_0),
-.Y(_13_)
-);
-\$_NOT_  _51_ (
-.A(req_1),
-.Y(_14_)
-);
-\$_OR_  _52_ (
-.A(state[0]),
-.B(state[1]),
-.Y(_15_)
+.B(_15_),
+.Y(_07_)
 );
-\$_OR_  _53_ (
-.A(_15_),
-.B(_06_),
+\$_ORNOT_  _51_ (
+.A(state[1]),
+.B(state[0]),
 .Y(_16_)
 );
-\$_ANDNOT_  _54_ (
-.A(_14_),
-.B(_16_),
+\$_OR_  _52_ (
+.A(_16_),
+.B(state[2]),
 .Y(_17_)
 );
-\$_ANDNOT_  _55_ (
-.A(_14_),
-.B(_11_),
+\$_AND_  _53_ (
+.A(_17_),
+.B(_14_),
 .Y(_18_)
 );
-\$_OR_  _56_ (
-.A(_18_),
-.B(_17_),
+\$_NOT_  _54_ (
+.A(state[2]),
 .Y(_19_)
 );
-\$_ANDNOT_  _57_ (
-.A(_13_),
-.B(_19_),
+\$_OR_  _55_ (
+.A(state[0]),
+.B(state[1]),
 .Y(_20_)
 );
-\$_ORNOT_  _58_ (
-.A(state[1]),
-.B(state[2]),
+\$_OR_  _56_ (
+.A(_20_),
+.B(_19_),
 .Y(_21_)
 );
-\$_ANDNOT_  _59_ (
+\$_AND_  _57_ (
 .A(_21_),
-.B(_08_),
+.B(_18_),
 .Y(_22_)
 );
-\$_ANDNOT_  _60_ (
-.A(_20_),
-.B(_22_),
-.Y(_01_)
-);
-\$_OR_  _61_ (
-.A(_12_),
-.B(req_0),
+\$_OR_  _58_ (
+.A(_16_),
+.B(_19_),
 .Y(_23_)
 );
-\$_ANDNOT_  _62_ (
+\$_AND_  _59_ (
 .A(_23_),
-.B(_17_),
-.Y(_02_)
-);
-\$_ANDNOT_  _63_ (
-.A(_03_),
-.B(_08_),
+.B(_22_),
 .Y(_24_)
 );
-\$_NAND_  _64_ (
+\$_ANDNOT_  _60_ (
+.A(_24_),
+.B(reset),
+.Y(_05_)
+);
+\$_OR_  _61_ (
 .A(_21_),
-.B(_24_),
+.B(reset),
 .Y(_25_)
 );
-\$_ANDNOT_  _65_ (
-.A(_04_),
-.B(_03_),
+\$_ANDNOT_  _62_ (
+.A(req_1),
+.B(_25_),
 .Y(_26_)
 );
-\$_OR_  _66_ (
-.A(req_1),
-.B(req_0),
+\$_OR_  _63_ (
+.A(_26_),
+.B(_07_),
 .Y(_27_)
 );
-\$_ANDNOT_  _67_ (
-.A(_08_),
-.B(_27_),
+\$_OR_  _64_ (
+.A(_23_),
+.B(reset),
 .Y(_28_)
 );
-\$_OR_  _68_ (
-.A(_28_),
-.B(_26_),
+\$_ANDNOT_  _65_ (
+.A(req_0),
+.B(_28_),
 .Y(_29_)
 );
-\$_ANDNOT_  _69_ (
-.A(_16_),
-.B(_29_),
+\$_OR_  _66_ (
+.A(_29_),
+.B(_05_),
 .Y(_30_)
 );
-\$_NAND_  _70_ (
+\$_OR_  _67_ (
 .A(_30_),
-.B(_25_),
-.Y(_37_[0])
+.B(_27_),
+.Y(_04_)
 );
-\$_NOR_  _71_ (
-.A(req_1),
-.B(req_0),
+\$_OR_  _68_ (
+.A(_17_),
+.B(reset),
 .Y(_31_)
 );
-\$_ANDNOT_  _72_ (
-.A(_08_),
-.B(_31_),
+\$_OR_  _69_ (
+.A(_31_),
+.B(req_0),
 .Y(_32_)
 );
-\$_ANDNOT_  _73_ (
-.A(_10_),
+\$_ANDNOT_  _70_ (
+.A(req_1),
 .B(_32_),
 .Y(_33_)
 );
-\$_ANDNOT_  _74_ (
-.A(_25_),
-.B(_33_),
-.Y(_37_[1])
+\$_OR_  _71_ (
+.A(_33_),
+.B(reset),
+.Y(_34_)
 );
-\$_ANDNOT_  _75_ (
-.A(state[2]),
-.B(state[1]),
-.Y(_37_[2])
+\$_OR_  _72_ (
+.A(_29_),
+.B(_26_),
+.Y(_10_)
 );
-\$_ANDNOT_  _76_ (
-.A(req_1),
-.B(_12_),
-.Y(_34_)
+\$_OR_  _73_ (
+.A(_10_),
+.B(_34_),
+.Y(_01_)
 );
-\$_ANDNOT_  _77_ (
+\$_ANDNOT_  _74_ (
 .A(req_0),
-.B(_16_),
+.B(_31_),
+.Y(_06_)
+);
+\$_OR_  _75_ (
+.A(_06_),
+.B(reset),
+.Y(_00_)
+);
+\$_ANDNOT_  _76_ (
+.A(_12_),
+.B(_31_),
 .Y(_35_)
 );
-\$_OR_  _78_ (
+\$_ANDNOT_  _77_ (
 .A(_35_),
-.B(_34_),
+.B(req_1),
 .Y(_36_)
 );
-\$_OR_  _79_ (
+\$_OR_  _78_ (
 .A(_36_),
-.B(_21_),
+.B(_33_),
+.Y(_37_)
+);
+\$_OR_  _79_ (
+.A(_37_),
+.B(_00_),
 .Y(_38_)
 );
+\$_ANDNOT_  _80_ (
+.A(req_0),
+.B(_15_),
+.Y(_39_)
+);
+\$_OR_  _81_ (
+.A(_39_),
+.B(_07_),
+.Y(_40_)
+);
+\$_OR_  _82_ (
+.A(_40_),
+.B(_10_),
+.Y(_41_)
+);
+\$_OR_  _83_ (
+.A(_41_),
+.B(_38_),
+.Y(_02_)
+);
+\$_OR_  _84_ (
+.A(_39_),
+.B(_38_),
+.Y(_03_)
+);
+\$_MUX_  _85_ (
+.A(_06_),
+.B(req_1),
+.S(_35_),
+.Y(_42_)
+);
+\$_OR_  _86_ (
+.A(_42_),
+.B(_39_),
+.Y(_08_)
+);
+\$_MUX_  _87_ (
+.A(req_0),
+.B(_42_),
+.S(_15_),
+.Y(_43_)
+);
+\$_ANDNOT_  _88_ (
+.A(_43_),
+.B(_26_),
+.Y(_44_)
+);
+\$_NOR_  _89_ (
+.A(_44_),
+.B(_29_),
+.Y(_09_)
+);
+\$_MUX_  _90_ (
+.A(_33_),
+.B(req_0),
+.S(_26_),
+.Y(_45_)
+);
+\$_MUX_  _91_ (
+.A(_45_),
+.B(req_1),
+.S(_29_),
+.Y(_11_)
+);
+(* \always_ff  = 32'd1 *)
 (* src = "dut.sv:16.5-50.12" *)
-\$_SDFFE_PP0P_  gnt_0_reg /* _80_ */ (
+\$_SDFFE_PP0P_  \state_reg[1]  /* _92_ */ (
 .C(clock),
-.D(_03_),
-.E(_00_),
-.Q(gnt_0),
-.R(reset)
+.D(_08_),
+.E(_03_),
+.Q(state[1]),
+.R(_04_)
 );
+(* \always_ff  = 32'd1 *)
 (* src = "dut.sv:16.5-50.12" *)
-\$_SDFFE_PP0P_  gnt_1_reg /* _81_ */ (
+\$_DFFE_PP_  gnt_1_reg /* _93_ */ (
 .C(clock),
-.D(_38_),
+.D(_11_),
 .E(_01_),
-.Q(gnt_1),
-.R(reset)
+.Q(gnt_1)
 );
+(* \always_ff  = 32'd1 *)
 (* src = "dut.sv:16.5-50.12" *)
-\$_SDFFE_PP1P_  \state_reg[0]  /* _82_ */ (
+\$_SDFFE_PP0P_  gnt_0_reg /* _94_ */ (
 .C(clock),
-.D(_37_[0]),
-.E(_02_),
-.Q(state[0]),
-.R(reset)
+.D(_06_),
+.E(_00_),
+.Q(gnt_0),
+.R(_07_)
 );
+(* \always_ff  = 32'd1 *)
 (* src = "dut.sv:16.5-50.12" *)
-\$_SDFFE_PP0P_  \state_reg[1]  /* _83_ */ (
+\$_SDFFE_PP1P_  \state_reg[0]  /* _95_ */ (
 .C(clock),
-.D(_37_[1]),
+.D(_09_),
 .E(_02_),
-.Q(state[1]),
-.R(reset)
+.Q(state[0]),
+.R(_05_)
 );
+(* \always_ff  = 32'd1 *)
 (* src = "dut.sv:16.5-50.12" *)
-\$_SDFFE_PP0P_  \state_reg[2]  /* _84_ */ (
+\$_SDFFE_PP0P_  \state_reg[2]  /* _96_ */ (
 .C(clock),
-.D(_37_[2]),
+.D(_10_),
 .E(_02_),
 .Q(state[2]),
-.R(reset)
+.R(_05_)
 );
 endmodule
